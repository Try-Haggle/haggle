# Haggle

**AI í˜‘ìƒ + ì˜¨ì²´ì¸ ê²°ì œ í”„ë¡œí† ì½œ ì¸í”„ë¼**
*"The Stripe of Negotiations"*

> ì´ ë¬¸ì„œëŠ” Haggleì˜ ëª¨ë“  ê°œë°œìê°€ ì°¸ê³ í•˜ëŠ” **Source of Truth**ì…ë‹ˆë‹¤.

---

## Company Overview

Haggleì€ AI Agentê°€ ìë™ìœ¼ë¡œ ê°€ê²©ì„ í˜‘ìƒí•˜ê³ , ìŠ¤í…Œì´ë¸”ì½”ì¸(USDC)ìœ¼ë¡œ ì¦‰ì‹œ ê²°ì œí•˜ëŠ” **í”„ë¡œí† ì½œ ì¸í”„ë¼**ì…ë‹ˆë‹¤. Stripeê°€ ì˜¨ë¼ì¸ ê²°ì œë¥¼ í‘œì¤€í™”í–ˆë“¯, Haggleì€ AI ì‹œëŒ€ì˜ í˜‘ìƒì„ í‘œì¤€í™”í•©ë‹ˆë‹¤.

**í•µì‹¬ ê°€ì¹˜:**
- êµ¬ë§¤ì: 10-20% í• ì¸, ìˆ˜ìˆ˜ë£Œ ë¶€ë‹´ ë¹„ìœ¨ë„ í˜‘ìƒ ê°€ëŠ¥
- íŒë§¤ì: ê¸°ì¡´ í”Œë«í¼ ëŒ€ë¹„ ë” ë†’ì€ ìˆ˜ë ¹ì•¡ (eBay 13% â†’ Haggle 1.5%)
- í”Œë«í¼: 96%+ ë§ˆì§„ìœ¨

**ë²•ì¸:** Delaware LLC
**ë„ë©”ì¸:** tryhaggle.ai

---

## Philosophy

### ë¯¸ì…˜
**"í˜‘ìƒì˜ ë¯¼ì£¼í™”"** â€” ëª¨ë“  ì‚¬ëŒì´ ê³µì •í•˜ê²Œ í˜‘ìƒí•  ìˆ˜ ìˆëŠ” ì„¸ìƒ.

### ë¹„ì „
**"P2P ê±°ë˜ì˜ í‘œì¤€"** â€” ê²°ì œì˜ Stripe, ì¸ì¦ì˜ OAuthì²˜ëŸ¼, í˜‘ìƒí•˜ë©´ Haggle.

### í•µì‹¬ ê°€ì¹˜
- **ê³µì •í•¨ (Fairness)** â€” ì–‘ìª½ì—ê²Œ ë™ë“±í•œ ì •ë³´ì™€ ê¶Œí•œ
- **íˆ¬ëª…í•¨ (Transparency)** â€” ìˆ˜ìˆ˜ë£Œ, ì‹ ë¢°ë„, ì¶œì²˜ë¥¼ í•­ìƒ ê³µê°œ
- **ì•ˆì „í•¨ (Safety)** â€” ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ê¸°ë°˜ ê²°ì œ
- **í¸ë¦¬í•¨ (Convenience)** â€” ìë™í™”ê°€ ê¸°ë³¸
- **ì •ì§í•¨ (Honesty)** â€” í‹€ë¦´ ìˆ˜ ìˆìŒì„ ì¸ì •

### ì„¤ê³„ ì›ì¹™
1. **ì‚¬ìš©ì ë³´í˜¸ ìš°ì„ ** â€” ìˆ˜ìµë³´ë‹¤ ì‚¬ìš©ì ë³´í˜¸ê°€ ë¨¼ì €
2. **ìë™í™”ê°€ ê¸°ë³¸** â€” ìˆ˜ë™ìœ¼ë¡œ í•  ì¼ì„ ìµœì†Œí™”
3. **í‘œì¤€ì´ ë  ì„¤ê³„** â€” API ìš°ì„ , ë¬¸ì„œí™” ê°•ë°•
4. **ì–‘ìª½ ëª¨ë‘ì—ê²Œ ê³µì •** â€” êµ¬ë§¤ì AI â‰  í”Œë«í¼ AI
5. **ë‹¨ìˆœí•¨ > ì™„ë²½í•¨** â€” ê¸°ëŠ¥ 100ê°œ < í•µì‹¬ ê¸°ëŠ¥ 10ê°œ
6. **ë°ì´í„°ëŠ” ì‚¬ìš©ì ê²ƒ** â€” ê±°ë˜ ìˆ˜ìˆ˜ë£Œë§Œ

### ì˜ì‚¬ê²°ì • ê°€ì´ë“œ
íŠ¸ë ˆì´ë“œì˜¤í”„ ìƒí™© ì‹œ: **ì•ˆì „ > í¸ë¦¬, ê³µì • > ìˆ˜ìµ, ë‹¨ìˆœ > ì™„ë²½, íˆ¬ëª… > íš¨ìœ¨**

---

## Monorepo êµ¬ì¡°

ì´ ì €ì¥ì†ŒëŠ” **MVP ì¤‘ì‹¬ monorepo**ì…ë‹ˆë‹¤. ê²°ì œ/ë¶„ìŸ ë“± MVPì— ë¶ˆí•„ìš”í•œ ê¸°ëŠ¥ì€ ë³„ë„ ë¸Œëœì¹˜ì—ì„œ ê°œë°œí•©ë‹ˆë‹¤.

```
haggle/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ api/                          â† Hono API ì„œë²„ (MCP ë¼ìš°í„° í¬í•¨)
â”‚   â””â”€â”€ web/                          â† Next.js í”„ë¡ íŠ¸ì—”ë“œ
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared/                       â† ê³µí†µ íƒ€ì…, ìƒìˆ˜, ìœ í‹¸ (DO NOT TOUCH)
â”‚   â”œâ”€â”€ db/                           â† Drizzle ORM + PostgreSQL (DO NOT TOUCH)
â”‚   â”œâ”€â”€ contracts/                    â† ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ (ìŠ¤í…)
â”‚   â”œâ”€â”€ engine-core/                  â† ìˆœìˆ˜ ìˆ˜í•™ ì—”ì§„ (83 tests, ì™¸ë¶€ ì˜ì¡´ì„± 0)
â”‚   â””â”€â”€ engine-session/               â† ì„¸ì…˜ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ (121+ tests)
â”œâ”€â”€ docs/                             â† ì‚¬ì—…/ì•„í‚¤í…ì²˜ ë¬¸ì„œ
â”œâ”€â”€ CLAUDE.md                         â† ì´ íŒŒì¼
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ turbo.json
â””â”€â”€ tsconfig.base.json
```

### íŒ¨í‚¤ì§€ ì˜ì¡´ì„± ê·¸ë˜í”„

```
shared â† db
       â† contracts
engine-core â† engine-session
```

> `engine-core`ì™€ `engine-session`ì€ `shared`/`db`ì™€ ì˜ì¡´ ê´€ê³„ ì—†ìŒ.
> ì¶”í›„ apps/apiì—ì„œ engine-sessionì„ importí•˜ì—¬ í˜‘ìƒ ë¼ìš´ë“œë¥¼ ì‹¤í–‰.

---

## íŒ¨í‚¤ì§€: @haggle/engine-core

ìˆœìˆ˜ ìˆ˜í•™ ê³„ì‚°ê¸°. DB/API/LLM í˜¸ì¶œ ì—†ìŒ. ì™¸ë¶€ ì˜ì¡´ì„± 0.

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `computeUtility(ctx)` | NegotiationContext â†’ UtilityResult (4ì°¨ì› íš¨ìš© ê³„ì‚°) |
| `makeDecision(utility, thresholds, session)` | U_total â†’ ACCEPT/COUNTER/REJECT/NEAR_DEAL/ESCALATE |
| `computeCounterOffer(params)` | Faratin ì–‘ë³´ ê³¡ì„ ìœ¼ë¡œ ì—­ì œì•ˆ ê°€ê²© ê³„ì‚° |
| `batchEvaluate(request)` | Nê°œ ë¦¬ìŠ¤íŒ… ì¼ê´„ í‰ê°€ + ìˆœìœ„ |
| `compareSessions(sessions)` | Nê°œ ì„¸ì…˜ ë¹„êµ + BATNA ì‚°ì¶œ |

## íŒ¨í‚¤ì§€: @haggle/engine-session

engine-core ìœ„ì˜ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ë ˆì´ì–´. ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬, HNP í”„ë¡œí† ì½œ íƒ€ì…, ë¼ìš´ë“œ ì‹¤í–‰ íŒŒì´í”„ë¼ì¸.
DB/API/LLM í˜¸ì¶œ ì—†ìŒ. LLM ì—ìŠ¤ì»¬ë ˆì´ì…˜ì€ `EscalationRequest` ë°˜í™˜.

| í•¨ìˆ˜/íƒ€ì… | ì„¤ëª… |
|-----------|------|
| `executeRound(session, strategy, offer, roundData)` | í•œ ë¼ìš´ë“œ ì‹¤í–‰ íŒŒì´í”„ë¼ì¸ |
| `assembleContext(strategy, roundData)` | MasterStrategy + RoundData â†’ NegotiationContext |
| `transition(status, event)` | ì„¸ì…˜ ìƒíƒœ ì „ì´ |
| `trackConcession(prev, current, role)` | ì–‘ë³´ ì—¬ë¶€ íŒë‹¨ |

---

## ê°œë°œ ëª…ë ¹ì–´

```bash
# ì „ì²´
pnpm install
pnpm build           # turbo build (ì „ì²´)
pnpm test            # turbo test (engine-core + engine-session)
pnpm typecheck       # turbo typecheck (ì „ì²´)

# ê°œë³„ íŒ¨í‚¤ì§€
pnpm --filter @haggle/engine-core test
pnpm --filter @haggle/engine-session test
```

---

## í•µì‹¬ ê·œì¹™ (Development Principles)

1. **Protocol-First**: ëª¨ë“  ê¸°ëŠ¥ì€ HNP í”„ë¡œí† ì½œ ìœ„ì— êµ¬ì¶•
2. **Cost-Aware**: LLM í˜¸ì¶œ ìµœì†Œí™”, Hot Path(ê·œì¹™ ê¸°ë°˜) ë¹„ìœ¨ ê·¹ëŒ€í™”
3. **Stateless Engine**: ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥í•œ ì„¤ê³„
4. **Event-Driven**: ëª¨ë“ˆ ê°„ ì§ì ‘ ì˜ì¡´ ê¸ˆì§€, ì´ë²¤íŠ¸ë¡œ í†µì‹ 
5. **Open Protocol, Closed Engine**: HNP ìŠ¤í™ì€ ê³µê°œ, ì—”ì§„ ë¡œì§ì€ ë¹„ê³µê°œ
6. **MVP-First**: main ë¸Œëœì¹˜ëŠ” MVP ì „ìš©. ê²°ì œ/ë¶„ìŸ ë“±ì€ ë³„ë„ ë¸Œëœì¹˜

---

## ë¸Œëœì¹˜ ì „ëµ

| ë¸Œëœì¹˜ | ìš©ë„ |
|--------|------|
| `main` | MVP ì „ìš© (í˜‘ìƒ ì—”ì§„ + ì›¹ì•± + API) |
| `feature/hnp-proto` | HNP Protobuf wire format (ì¶”í›„) |
| `feature/dispute-system` | 3-Tier ë¶„ìŸ í•´ê²° ì‹œìŠ¤í…œ (ì¶”í›„) |
| `feature/settlement` | USDC ê²°ì œ ì—°ë™ (ì¶”í›„) |

---

## ğŸ“„ ìƒì„¸ ë¬¸ì„œ (`/docs`)

| ë¬¸ì„œ | ë‚´ìš© |
|------|------|
| [MVP_Final_Implementation_Plan.md](./docs/MVP_Final_Implementation_Plan.md) | MVP êµ¬í˜„ ê³„íš |
| [Slice_0_Implementation_Plan.md](./docs/Slice_0_Implementation_Plan.md) | Slice 0 êµ¬í˜„ ê³„íš |

---

*Last Updated: 2026-02-17*
*Version: 2.0*
